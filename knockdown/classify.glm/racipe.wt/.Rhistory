unique(mydata$CLUSTER_NO)
# randomize data
set.seed(1)
mydata <- mydata[sample(nrow(mydata)), ]
x <- model.matrix(CLUSTER_NO ~., mydata)[,-1]
y <- ifelse(mydata$CLUSTER_NO == 1, 1, 0)
head(y)
cv.glmnet.obj <- cv.glmnet(x, y, alpha = 1.0, family = "binomial")
glmnet.model <- glmnet(x, y, alpha = 1, family = "binomial",
lambda = cv.glmnet.obj$lambda.1se #cv.glmnet.obj$lambda.min
)
fname.out <- paste(outdir, 'cv.glmnet.obj.rds', sep = '')
saveRDS(cv.glmnet.obj, file = fname.out)
fname.out <- paste(outdir, 'glmnet.model.rds', sep = '')
saveRDS(glmnet.model, file = fname.out)
#!/usr/bin/env Rscript
remove(list = ls())
# library(tidyverse)
library(glmnet)
NO_CLUSTERS.REF <- 2 # 3
outdir  <- './data/'
dir.create(outdir )
# Load training data
#-------------------
NO_META_COLS = 1
fname_data <- './data/racipe.models.wt.labeled.csv'
mydata = read.csv(file=fname_data, header=TRUE)
dim(mydata)
mydata <- mydata[mydata$CLUSTER_NO!=3, ]
dim(mydata)
mydata$CLUSTER_NO <- as.numeric(mydata$CLUSTER_NO==1)
mydata$CLUSTER_NO <- factor(mydata$CLUSTER_NO)
unique(mydata$CLUSTER_NO)
# randomize data
set.seed(1)
mydata <- mydata[sample(nrow(mydata)), ]
x <- model.matrix(CLUSTER_NO ~., mydata)[,-1]
y <- ifelse(mydata$CLUSTER_NO == 1, 1, 0)
head(y)
cv.glmnet.obj <- cv.glmnet(x, y, alpha = 1.0, family = "binomial")
model.glmnet <- glmnet(x, y, alpha = 1, family = "binomial",
lambda = cv.glmnet.obj$lambda.1se #cv.glmnet.obj$lambda.min
)
fname.out <- paste(outdir, 'cv.glmnet.obj.rds', sep = '')
saveRDS(cv.glmnet.obj, file = fname.out)
fname.out <- paste(outdir, 'model.glmnet.rds', sep = '')
saveRDS(model.glmnet, file = fname.out)
remove(list = ls())
library(sRACIPE)
NO_CLUSTERS.REF <- 2
XLIMIT <- c(-11, 5)
YLIMIT <- c(-4, 5)
cluster_names <- c('CL1', 'CL2')
names(cluster_names) <- c('Untreated', 'AML')
color_vector = c("dodgerblue", "red") # CL1, CL2
figdir <- './figs.wt.clusters/'
dir.create(figdir)
source('./functions.classify_models.R')
datadir <- './data/'
NO_META_COLS = 1
fname_data <- '../racipe.wt/data/racipe.models.wt.labeled.csv'
mydata = read.csv(file=fname_data, header=TRUE)
dim(mydata)
mydata.saved <- mydata
mydata <- mydata[mydata$CLUSTER_NO!=3, ]
dim(mydata)
ndata <- mydata[, (NO_META_COLS+1):ncol(mydata)]
pca <- prcomp(ndata)
eigs <- pca$sdev^2
stat <- rbind(SD = sqrt(eigs),
Proportion = eigs/sum(eigs),
Cumulative = cumsum(eigs)/sum(eigs))
View(mydata)
prData.wt <- scale(mydata[, 2:ncol(mydata)] , pca$center, pca$scale) %*%  pca$rotation
mainstr <- paste(' Models: Untreated' , sep = '')
plot(pca$x[,1], pca$x[,2], #xlim=XLIMIT, ylim=YLIMIT,
main=mainstr, col='gray', pch=19, cex=0.05,
xlab=paste('PC1 (', format(stat[2,1]*100, digits = 5), '%)' , sep = ''),
ylab=paste('PC2 (', format(stat[2,2]*100, digits = 4), '%)' , sep = '')
)
for(cluster.no in 1:NO_CLUSTERS.REF){
prCluster=prData.kd[ndata.kd$CLUSTER_NO==cluster.no,]
if(is.vector(prCluster)) {
points(prCluster[1], prCluster[2], pch=19,cex=0.5, col=color_vector[cluster.no])
}
else{
points(prCluster[,1], prCluster[,2],pch=19,cex=0.5, col=color_vector[cluster.no])
}
# dataEllipse(prCluster[,1], prCluster[,2],
#             levels=c(0.8), add=TRUE, col=color_vector[cluster.no+1],
#             center.pch = 19,center.cex = 1.5, pch=1, cex=0.05, plot.points=TRUE,
#             fill=TRUE, fill.alpha=0.1)
# break()
}
for(cluster.no in 1:NO_CLUSTERS.REF){
prCluster=prData.wt[mydata$CLUSTER_NO==cluster.no,]
if(is.vector(prCluster)) {
points(prCluster[1], prCluster[2], pch=19,cex=0.5, col=color_vector[cluster.no])
}
else{
points(prCluster[,1], prCluster[,2],pch=19,cex=0.5, col=color_vector[cluster.no])
}
# dataEllipse(prCluster[,1], prCluster[,2],
#             levels=c(0.8), add=TRUE, col=color_vector[cluster.no+1],
#             center.pch = 19,center.cex = 1.5, pch=1, cex=0.05, plot.points=TRUE,
#             fill=TRUE, fill.alpha=0.1)
# break()
}
WIDTH <- 3
HEIGHT <- 3
figname <- paste(figdir, 'legend-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
plot(pca$x[,1], pca$x[,2], xlim=XLIMIT, ylim=YLIMIT,
col='white', pch=19, cex=0.005, xlab='PC1', ylab='PC2')
legend(XLIMIT[1], (YLIMIT[2]-1), names(cluster_names), color_vector, bty='n')
mainstr <- paste(' Models: Untreated' , sep = '')
figname <- paste(figdir, 'clusters_on_PCs.wt-', gene_name,'-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
plot(pca$x[,1], pca$x[,2], #xlim=XLIMIT, ylim=YLIMIT,
main=mainstr, col='gray', pch=19, cex=0.05,
xlab=paste('PC1 (', format(stat[2,1]*100, digits = 5), '%)' , sep = ''),
ylab=paste('PC2 (', format(stat[2,2]*100, digits = 4), '%)' , sep = '')
)
for(cluster.no in 1:NO_CLUSTERS.REF){
prCluster=prData.wt[mydata$CLUSTER_NO==cluster.no,]
if(is.vector(prCluster)) {
points(prCluster[1], prCluster[2], pch=19,cex=0.5, col=color_vector[cluster.no])
}
else{
points(prCluster[,1], prCluster[,2],pch=19,cex=0.5, col=color_vector[cluster.no])
}
}
#legend(-1, (YLIMIT[1]+7), names(cluster_names), color_vector, bty='n')
dev.off()
figname <- paste(figdir, 'clusters_on_PCs.wt-', gene_name,'-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
figname <- paste(figdir, 'clusters_on_PCs.wt-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
plot(pca$x[,1], pca$x[,2], #xlim=XLIMIT, ylim=YLIMIT,
main=mainstr, col='gray', pch=19, cex=0.05,
xlab=paste('PC1 (', format(stat[2,1]*100, digits = 5), '%)' , sep = ''),
ylab=paste('PC2 (', format(stat[2,2]*100, digits = 4), '%)' , sep = '')
)
for(cluster.no in 1:NO_CLUSTERS.REF){
prCluster=prData.wt[mydata$CLUSTER_NO==cluster.no,]
if(is.vector(prCluster)) {
points(prCluster[1], prCluster[2], pch=19,cex=0.5, col=color_vector[cluster.no])
}
else{
points(prCluster[,1], prCluster[,2],pch=19,cex=0.5, col=color_vector[cluster.no])
}
}
dev.off()
dev.list()
dev.off()
dev.off()
figname <- paste(figdir, 'clusters_on_PCs.wt-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
plot(pca$x[,1], pca$x[,2], #xlim=XLIMIT, ylim=YLIMIT,
main=mainstr, col='gray', pch=19, cex=0.05,
xlab=paste('PC1 (', format(stat[2,1]*100, digits = 5), '%)' , sep = ''),
ylab=paste('PC2 (', format(stat[2,2]*100, digits = 4), '%)' , sep = '')
)
for(cluster.no in 1:NO_CLUSTERS.REF){
prCluster=prData.wt[mydata$CLUSTER_NO==cluster.no,]
if(is.vector(prCluster)) {
points(prCluster[1], prCluster[2], pch=19,cex=0.5, col=color_vector[cluster.no])
}
else{
points(prCluster[,1], prCluster[,2],pch=19,cex=0.5, col=color_vector[cluster.no])
}
}
#legend(-1, (YLIMIT[1]+7), names(cluster_names), color_vector, bty='n')
dev.off()
WIDTH <- 3
HEIGHT <- 3
figname <- paste(figdir, 'legend-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
plot(pca$x[,1], pca$x[,2], xlim=XLIMIT, ylim=YLIMIT,
col='white', pch=19, cex=0.005, xlab='PC1', ylab='PC2')
legend(XLIMIT[1], (YLIMIT[2]-1), names(cluster_names), color_vector, bty='n')
dev.off()
WIDTH <- 6
HEIGHT <- 5
figname <- paste(figdir, 'clusters_on_PCs.wt-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
plot(pca$x[,1], pca$x[,2], #xlim=XLIMIT, ylim=YLIMIT,
main=mainstr, col='gray', pch=19, cex=0.05,
xlab=paste('PC1 (', format(stat[2,1]*100, digits = 5), '%)' , sep = ''),
ylab=paste('PC2 (', format(stat[2,2]*100, digits = 4), '%)' , sep = '')
)
for(cluster.no in 1:NO_CLUSTERS.REF){
prCluster=prData.wt[mydata$CLUSTER_NO==cluster.no,]
if(is.vector(prCluster)) {
points(prCluster[1], prCluster[2], pch=19,cex=0.5, col=color_vector[cluster.no])
}
else{
points(prCluster[,1], prCluster[,2],pch=19,cex=0.5, col=color_vector[cluster.no])
}
}
#legend(-1, (YLIMIT[1]+7), names(cluster_names), color_vector, bty='n')
dev.off()
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'mean_sd.racipe.models.wt.csv', sep='')
mean_sd.df <- read.csv(fname, row.names = 1)
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
ndata.df <- read.csv(fname)
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
ndata.df <- read.csv(fname)
data.df <- as.data.frame(matrix(nrow = nrow(ndata.df), ncol = ncol(ndata.df)))
colnames(data.df) <- colnames(ndata.df)
plot(data.df$ATM)
plot(data.df$ATM)
hist(data.df$ATM)
hist(data.df$ATM)
class(data.df$ATM)
data.df$ATM
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
ndata.df <- read.csv(fname)
data.df <- as.data.frame(matrix(nrow = nrow(ndata.df), ncol = ncol(ndata.df)))
colnames(data.df) <- colnames(ndata.df)
hist(data.df$ATM)
View(data.df)
View(data.df)
getwd()
View(ndata.df)
data.df <- as.data.frame(matrix(nrow = nrow(ndata.df), ncol = ncol(ndata.df)))
colnames(data.df) <- colnames(ndata.df)
hist(ndata.df$ATM)
hist(ndata.df$EF1)
hist(ndata.df$E2F1)
plot(ndata.df$E2F1)
plot(ndata.df$CLUSTER_NO,ndata.df$E2F1)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
ndata.df <- ndata.df[ndata.df$CLUSTER_NO!=3,]
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
length(ndata.df)
dim(ndata.df)
ndata.df <- read.csv(fname)
ndata.df <- ndata.df[ndata.df$CLUSTER_NO!=3,]
par(mfrow=c(6,5))
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
dev.off()
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO)
break()
}
gene.name
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO, xlab = gene.name, ylab = 'clusters')
break()
}
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
plot(ndata.df$CLUSTER_NO, ndata.df$E2F1)
plot(ndata.df$E2F1, ndata.df$CLUSTER_NO)
hist(ndata.df$E2F1)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
hist(ndata.df$ATM)
hist(ndata.df$E2F1)
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
#plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO, xlab = gene.name, ylab = 'clusters')
hist(ndata.df[,gene.name])
break()
}
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(6,5))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(6,5))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(6,5))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(6,5))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(4,5))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(4,2))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(2,2))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(2,2))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '')
break()
}
hist(ndata.df[,gene.name], xlab = '', ylab = '')
par(mfrow=c(2,2))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
par(mfrow=c(2,2))
par(fig=c(0,0.8,0,0.8), new=TRUE)
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
par(mfrow=c(2,2))
par(fig=c(0,0.8,0,0.8), new=TRUE)
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
par(mfrow=c(2,2))
par(fig=c(0,0.8,0,0.8), new=TRUE)
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
dev.off()
par(mfrow=c(2,2))
par(fig=c(0,0.8,0,0.8), new=TRUE)
par(fig=c(0,0.8,0,0.8))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
par(mfrow=c(2,2))
par(mar=c(1.1,1.1,1.1,1.1)
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
#plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO, xlab = gene.name, ylab = 'clusters')
hist(ndata.df[,gene.name])
break()
}
par(mfrow=c(2,2))
par(mar=c(1.1,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
par(mfrow=c(5,6))
par(mar=c(1.1,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
figdir <- './figs.genes/'
dir.create(figdir)
figdir <- './figs.genes/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(1.1,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
break()
}
dev.off()
figdir <- './figs.genes/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(1.1,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(5.1,1.1,1.1,1.1)) #
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
figdir <- './figs.genes/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(3.1,1.1,1.1,1.1)) #
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
figdir <- './figs.genes/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.0,1.1,1.1,1.1)) #
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
figdir <- './figs.genes/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1)) #
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
hist(ndata.df[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO, xlab = gene.name, ylab = 'clusters')
break()
}
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'gene.exp-vs-cluster.no-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO, xlab = gene.name, ylab = 'clusters')
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'gene.exp-vs-cluster.no-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
plot(ndata.df[,gene.name], ndata.df$CLUSTER_NO, xlab = gene.name, ylab = 'clusters',
main = gene.name)
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'cluster.no-vs-gene.exp-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(ndata.df)[2:dim(ndata.df)[2]]){
plot(ndata.df$CLUSTER_NO, ndata.df[,gene.name], xlab = gene.name, ylab = 'clusters',
main = gene.name)
#break()
}
dev.off()
