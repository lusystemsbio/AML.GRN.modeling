hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-before.normed-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.normed.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-after.normed-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
remove(list = ls())
library(sRACIPE)
datadir <- './data/'
dir.create(datadir)
circuit_idx <- '0.09-32-0.85'
# import simulated data
#----------------------
racipe <- readRDS(file = paste('../../../networks/circuits.sim/circuit_simulated_',
circuit_idx, '.rds', sep = '') )
geneExpression <- assay(racipe,1)
geneExpression <- log2(1+geneExpression)
means <- rowMeans(geneExpression)
sds <-  apply(geneExpression, 1, sd)
# Store mean and sd of the untreated data
#-----------------------------------------
mean_sd.df <- cbind(names(means), means, sds)
colnames(mean_sd.df) <- c('tf' ,'mean', 'sd')
fname.out <- paste(datadir, 'mean_sd.racipe.models.wt.csv', sep='')
write.csv(mean_sd.df, file = fname.out, quote = F, row.names = FALSE)
# store racipe data (log transfer)
#----------------------------------
fname.out <- paste(datadir, 'geneExpression.csv', sep='')
write.csv(t(geneExpression), file = fname.out, quote = F, row.names = FALSE)
# normalize data
#---------------
mydata.df <- as.data.frame(t(geneExpression))
mean(mydata$ATM)
sd(mydata$ATM)
ndata.df <- mydata.df
for(gene.name in rownames(mean_sd.df)){
print(gene.name)
ndata.df[, gene.name] <- (mydata.df[, gene.name] - as.numeric(mean_sd.df[gene.name, 'mean']))/as.numeric(mean_sd.df[gene.name, 'sd'])
}
fname.out <- paste(datadir, 'geneExpression.zscore.csv', sep='')
write.csv(ndata.df, file = fname.out, quote = F, row.names = FALSE)
mydata.df <- as.data.frame(t(geneExpression))
ndata.df <- mydata.df
mydata.df <- as.data.frame(t(geneExpression))
ndata.df <- mydata.df
for(gene.name in rownames(mean_sd.df)){
print(gene.name)
ndata.df[, gene.name] <- (mydata.df[, gene.name] - min(mydata.df[, gene.name]))/(max(mydata.df[, gene.name]) - min(mydata.df[, gene.name]))
}
fname.out <- paste(datadir, 'geneExpression.normed.csv', sep='')
write.csv(ndata.df, file = fname.out, quote = F, row.names = FALSE)
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.zscores.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-zscores-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.zscores.csv', sep='')
mydata <- read.csv(fname)
fname <- paste(datadir, 'geneExpression.zscore.csv', sep='')
mydata <- read.csv(fname)
hist(mydata$ATM)
hist(mydata$E2F1)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-zscores-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.normed.csv', sep='')
mydata <- read.csv(fname)
hist(mydata$ATM)
hist(mydata$E2F1)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.normed.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-normed.data-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.before.normed/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-rawData-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.normed.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-normed.data-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-rawData-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- './data/'
fname <- paste(datadir, 'geneExpression.zscore.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.hist/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-zscores-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
remove(list = ls())
datadir <- '../racipe.wt/data/'
fname <- paste(datadir, 'acipe.models.wt.labeled.csv', sep='')
mydata <- read.csv(fname)
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
mydata <- read.csv(fname)
hist(mydata$ATM)
hist(mydata$E2F1)
figdir <- './figs.clustered.data/'
dir.create(figdir)
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- '../racipe.wt/data/'
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
mydata <- read.csv(fname)
#mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.clustered.data/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'gene.exp-vs-cluster.no-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)[2:dim(mydata)[2]]){
plot(mydata[,gene.name], mydata$CLUSTER_NO, xlab = gene.name, ylab = 'clusters',
main = gene.name)
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'cluster.no-vs-gene.exp-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)[2:dim(mydata)[2]]){
plot(mydata$CLUSTER_NO, mydata[,gene.name], xlab = gene.name, ylab = 'clusters',
main = gene.name)
#break()
}
dev.off()
#!/usr/bin/env Rscript
remove(list = ls())
datadir <- '../racipe.wt/data/'
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
mydata <- read.csv(fname)
mydata <- mydata[mydata$CLUSTER_NO!=3,]
hist(mydata$ATM)
hist(mydata$E2F1)
#plot(mydata$CLUSTER_NO, mydata$E2F1)
#plot(mydata$E2F1, mydata$CLUSTER_NO)
figdir <- './figs.clustered.data/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'gene.exp-vs-cluster.no-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)[2:dim(mydata)[2]]){
plot(mydata[,gene.name], mydata$CLUSTER_NO, xlab = gene.name, ylab = 'clusters',
main = gene.name)
#break()
}
dev.off()
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'cluster.no-vs-gene.exp-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)[2:dim(mydata)[2]]){
plot(mydata$CLUSTER_NO, mydata[,gene.name], xlab = gene.name, ylab = 'clusters',
main = gene.name)
#break()
}
dev.off()
figdir <- './figs.clustered.data/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)[2:dim(mydata)[2]])){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
figdir <- './figs.clustered.data/'
dir.create(figdir)
WIDTH <- 8
HEIGHT <- 12
figname <- paste(figdir, 'hist-genes-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
pdf(file = figname, width = WIDTH, height = HEIGHT, paper = 'special')
par(mfrow=c(5,6))
par(mar=c(2.5,1.1,1.1,1.1))
for(gene.name in colnames(mydata)[2:dim(mydata)[2]]){
hist(mydata[,gene.name], xlab = '', ylab = '', main = gene.name)
#break()
}
dev.off()
dim(mydata)
fname.out <- paste(datadir, 'sim.exp.data.csv', sep='')
write.csv(mydata, file = fname.out, quote = F, row.names = FALSE)
fname.out <- paste('./data/sim.exp.data.csv', sep='')
write.csv(mydata, file = fname.out, quote = F, row.names = FALSE)
remove(list = ls())
datadir <- '../racipe.wt/data/'
fname <- paste(datadir, 'racipe.models.wt.labeled.csv', sep='')
mydata <- read.csv(fname)
mydata <- mydata[mydata$CLUSTER_NO!=3,]
View(mydata)
mydata <- mydata[,-c(1)]
cor.mydata <- cor(mydata)
dim(cor.mydata)
n <- dim(cor.mydata)[1]
cor.lin <- vector(mode = 'numeric', length = (n*(n+1)/2))
length(cor.lin)
count <- 1
for(i in 1:n){
for(j in i:n){
cor.lin[count] <- cor.mydata[i][j]
count <- count+1
}
}
hist(cor.lin)
max(cor.lin)
cor.lin <- vector(mode = 'numeric', length = (n*(n+1)/2))
length(cor.lin)
count <- 1
for(i in 1:n){
for(j in i:n){
cor.lin[count] <- cor.mydata[i][j]
count <- count+1
}
}
max(cor.lin)
max(cor.mydata)
min(cor.mydata)
cor.mydata
min(cor.mydata)
dim(cor.mydata)
cor.mydata[1,1]
count <- 1
for(i in 1:n){
for(j in i:n){
cor.lin[count] <- cor.mydata[i, j]
count <- count+1
}
}
max(cor.lin)
cor.mydata[1,1]
hist(cor.lin)
cor.lin <- vector(mode = 'numeric', length = (n*(n-1)/2))
length(cor.lin)
count <- 1
for(i in 2:n){
for(j in i:n){
cor.lin[count] <- cor.mydata[i, j]
count <- count+1
}
}
max(cor.lin)
hist(cor.lin)
max(cor.lin)
which(cor.mydata==1)
cor.lin <- vector(mode = 'numeric', length = (n*(n-1)/2))
length(cor.lin)
count <- 1
for(i in 2:n){
for(j in i:n){
cor.lin[count] <- cor.mydata[i, j]
count <- count+1
}
}
max(cor.lin)
hist(cor.lin)
which(cor.mydata==1)
sum(cor.lin==1)
cor.lin <- vector(mode = 'numeric', length = (n*(n-1)/2))
length(cor.lin)
count <- 1
for(i in 1:n){
for(j in (i+1):n){
cor.lin[count] <- cor.mydata[i, j]
count <- count+1
}
}
cor.lin <- vector(mode = 'numeric', length = (n*(n-1)/2))
length(cor.lin)
count <- 1
for(i in 1:(n-1)){
for(j in (i+1):n){
cor.lin[count] <- cor.mydata[i, j]
count <- count+1
}
}
max(cor.lin)
hist(cor.lin)
which(cor.mydata==1)
max(cor.lin)
count
length(cor.lin)
max(cor.lin)
hist(cor.lin)
which(cor.mydata==1)
sum(cor.lin==1)
hist(cor.lin)
sum(cor.lin==1)
