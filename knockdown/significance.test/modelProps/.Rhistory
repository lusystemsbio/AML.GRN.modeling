p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = -1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5),
axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 0.5),
#axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
#axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = -0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.0, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.0, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.0, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.0, vjust = 2),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.0, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 2, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = -1, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 0, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 2, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = 6, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = -2, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
theme(text = element_text(size=SIZE.TICK_LABEL),
axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.95, vjust = 0),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.95, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 15, hjust = 0.95, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.95, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.86, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.95, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.98, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 1),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='-log (pvalue)')
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='fold change')
p4
fname.out <- paste(figdir, 'foldChange-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
WIDTH <- 4
HEIGHT <- 12
fname.out <- paste(figdir, 'foldChange-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
ggsave(filename = fname.out, p4, width = WIDTH, height = HEIGHT)
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='Fold change')
p4
WIDTH <- 4
HEIGHT <- 12
fname.out <- paste(figdir, 'foldChange-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
ggsave(filename = fname.out, p4, width = WIDTH, height = HEIGHT)
p4
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_blank())
p2
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='Fold change')
p4
p4
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='Fold change')
p4
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = -1, vjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 0.0, vjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1.0, vjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='Fold change')
p4
remove(list = ls())
datadir <- './data/'
figdir <- './figs.sig.test/'
dir.create(figdir)
fname.data <- paste(datadir , 'stats.Chi-squared_test.csv', sep = '')
stats.TF <- read.csv(file = fname.data, row.names = 1)
stats.TF$TF <- factor(stats.TF$TF, levels = stats.TF$TF)
SIG.LEVEL <- 0.05
YLIMIT <- c(0.0, 2.0)
OFFSET.VERTICAL <- 0.08
print(-log10(SIG.LEVEL))
library(gridExtra)
library(ggplot2)
DOT.SIZE <- 0.7
SIZE.TICK_LABEL <- 12
YLIMIT <- c(0.0,  2.65) # max(stats.TF$nlogpvalue)
plot_title <- paste('-log (pvalue)',
sep = '  ')
p1 <- ggplot(stats.TF, aes(x = TF, y = nlogpvalue)) +
geom_dotplot(binaxis = 'y', stackdir = 'center',
dotsize=DOT.SIZE) +
ylim(YLIMIT) +
coord_flip()
p1
View(stats.TF)
View(stats.TF)
remove(list = ls())
datadir <- './data/'
figdir <- './figs.foldChange/'
dir.create(figdir)
fname.data <- paste(datadir , 'foldChange.csv', sep = '')
foldChange <- read.csv(file = fname.data, row.names = NULL)
foldChange$tf <- factor(foldChange$tf, levels = foldChange$tf)
View(foldChange)
SIG.LEVEL <- 0.05
YLIMIT <- c(0.0, 2.0)
OFFSET.VERTICAL <- 0.08
library(gridExtra)
library(ggplot2)
DOT.SIZE <- 0.7
SIZE.TICK_LABEL <- 12
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
class(foldChange$tf)
class(foldChange$foldChange)
rownames(foldChange) <- foldChange$tf
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
?stackdir
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity", alpha=0.5) +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p1 <- ggplot(foldChange, aes(x = tf, y = foldChange)) +
geom_bar(aes(x=tf, y=foldChange), stat="identity") +
# theme(text = element_text(size=SIZE.TICK_LABEL),
#       axis.text.x = element_text(angle = 90, vjust = -1, hjust=1)) +
coord_flip()
p1
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, hjust = 1.0, vjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 0.0)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.0, hjust = 0.0)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 1.0, hjust = 0.0)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 0.0)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 0)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = -1)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 1.5, hjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 1.0, hjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.0, hjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = -0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 0.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1.0)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p2 <- p1 + theme(text = element_text(size=SIZE.TICK_LABEL),
#axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1.5)#,
#axis.title.x = element_blank(), axis.title.y = element_blank()
)
p2
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='Fold change')
p4
p4 <- p2 + labs(x='Transcription Factor or Transcription Factor Pair', y='Fold Change')
p4
p4 <- p2 + labs(x='Condition', y='Fold Change')
p4
WIDTH <- 4
HEIGHT <- 12
fname.out <- paste(figdir, 'foldChange-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
ggsave(filename = fname.out, p4, width = WIDTH, height = HEIGHT)
WIDTH <- 6
HEIGHT <- 12
fname.out <- paste(figdir, 'foldChange-', WIDTH, 'x', HEIGHT,'.pdf', sep = '')
ggsave(filename = fname.out, p4, width = WIDTH, height = HEIGHT)
remove(list = ls())
remove(list = ls())
datadir <- './data/'
figdir <- './figs.sig.test/'
dir.create(figdir)
fname.data <- paste(datadir , 'stats.Chi-squared_test.csv', sep = '')
stats.TF <- read.csv(file = fname.data, row.names = 1)
stats.TF$TF <- factor(stats.TF$TF, levels = stats.TF$TF)
SIG.LEVEL <- 0.05
YLIMIT <- c(0.0, 2.0)
OFFSET.VERTICAL <- 0.08
print(-log10(SIG.LEVEL))
library(gridExtra)
library(ggplot2)
DOT.SIZE <- 0.7
SIZE.TICK_LABEL <- 12
YLIMIT <- c(0.0,  2.65) # max(stats.TF$nlogpvalue)
plot_title <- paste('-log (pvalue)',
sep = '  ')
p1 <- ggplot(stats.TF, aes(x = TF, y = nlogpvalue)) +
geom_dotplot(binaxis = 'y', stackdir = 'center',
dotsize=DOT.SIZE) +
ylim(YLIMIT) +
coord_flip()
p1
View(stats.TF)
min(stats.TF$nlogpvalue)
max(stats.TF$nlogpvalue)
YLIMIT <- c(0.0,  2.71) #2.65) # max(stats.TF$nlogpvalue)
plot_title <- paste('-log (pvalue)',
sep = '  ')
p1 <- ggplot(stats.TF, aes(x = TF, y = nlogpvalue)) +
geom_dotplot(binaxis = 'y', stackdir = 'center',
dotsize=DOT.SIZE) +
ylim(YLIMIT) +
coord_flip()
p1
