names(circuit_names)
circuit.1
circuit_names[circuit.1]
circuit_names[[circuit.1]]
circuit_names[circuit.1]
circuit.1
names(circuit_names)
circuit_names[n1]
names(circuit_names[n1])
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 3))
colnames(common.nodes.df) <- c('circuit.pair', 'num_nodes', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
print(n1)
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
print(n2)
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
remove(list = ls())
circuit_names <- c('circuit_1', 'circuit_2', 'circuit_3', 'circuit_4')
circuit_indices <- c('0.07-32-0.75', '0.07-32-0', '0.09-32-0.85', '0.16-28-0.85')
names(circuit_names) <- circuit_indices
library(sRACIPE)
outdir <- './data/'
dir.create(outdir)
# Extact circuits
#-----------------
tpo.list <- list()
nodes.byCircuit <- list()
for(circuit_idx in names(circuit_names)){
racipe <- readRDS(file = paste('../circuits.sim/circuit_simulated_',
circuit_idx, '.rds', sep = '') )
circuit_tpo <- sracipeCircuit(racipe)
fname.out <- paste(outdir, 'circuit-', circuit_idx, '.tpo' ,sep = '')
write.table(circuit_tpo, file = fname.out, sep = '\t', quote = F, row.names = F)
tpo.list[[circuit_names[circuit_idx]]] <- circuit_tpo
TFs_in_circuit <- union(circuit_tpo$Source, circuit_tpo$Target)
nodes.byCircuit[[circuit_names[circuit_idx]]] <- TFs_in_circuit
}
names(tpo.list)
names(nodes.byCircuit)
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 3))
colnames(common.nodes.df) <- c('circuit.pair', 'num_nodes', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
print(n1)
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
print(n2)
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 4))
colnames(common.nodes.df) <- c('circuit.pair', 'num_common.nodes', 'nodeCount.pair', 'circuit.idx.pair')
count.pair <- 1
length(nodes.byCircuit[[circuit.1]])
length(nodes.byCircuit[[circuit.1]])
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 4))
colnames(common.nodes.df) <- c('circuit.pair', 'num_common.nodes', 'nodeCount.pair', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(length(nodes.byCircuit[[circuit.1]]), '_', length(nodes.byCircuit[[circuit.1]]), sep = ''),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 4))
colnames(common.nodes.df) <- c('circuit.pair', 'num_common.nodes', 'nodeCount.pair', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(length(nodes.byCircuit[[circuit.1]]), '_', length(nodes.byCircuit[[circuit.2]]), sep = ''),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 4))
colnames(common.nodes.df) <- c('circuit.pair', 'num_common.nodes', 'nodeCount.pair', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(length(nodes.byCircuit[[circuit.1]]), '_', length(nodes.byCircuit[[circuit.2]]), sep = ''),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
write.csv(common.nodes.df, file = paste(outdir, 'common.nodes.csv', sep = ''), quote = F, row.names = F)
for(n1 in 1:(length(circuit_names))){
}
for(n1 in 1:(length(circuit_names))){
circuit.1 <- as.character(circuit_names[n1])
print(circuit.1)
}
nodes.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
colnames(nodes.df) <- c('circuit.name', 'num_nodes', 'circuit.idx')
count.circuit <- 1
nodes.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
colnames(nodes.df) <- c('circuit.name', 'num_nodes', 'circuit.idx')
nodes.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
colnames(nodes.df) <- c('circuit.name', 'num_nodes', 'circuit.idx')
count.circuit <- 1
for(n1 in 1:(length(circuit_names))){
circuit.name <- as.character(circuit_names[n1])
print(circuit.name)
nodes.df[count.circuit, ] <- c(circuit.name,  nodes.byCircuit[[circuit.name]],  names(circuit_names[n1]))
count.circuit <- count.circuit + 1
}
circuit.name
View(nodes.df)
nodes.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
colnames(nodes.df) <- c('circuit.name', 'num_nodes', 'circuit.idx')
count.circuit <- 1
for(n1 in 1:(length(circuit_names))){
circuit.name <- as.character(circuit_names[n1])
print(circuit.name)
nodes.df[count.circuit, ] <- c(circuit.name,  length(nodes.byCircuit[[circuit.name]]),  names(circuit_names[n1]))
count.circuit <- count.circuit + 1
}
write.csv(nodes.df, file = paste(outdir, 'nodes.csv', sep = ''), quote = F, row.names = F)
View(nodes.df)
circuit_names
as.character(circuit_names)
circuit_indices.o <- c('0.16-28-0.85', '0.09-32-0.85', '0.07-32-0.75', '0.07-32-0')
circuit.names.o <- c('circuit_4', 'circuit_3', 'circuit_1', 'circuit_2')
nodes.df
names(circuit.names) <- circuit_indices
circuit_indices <- c('0.16-28-0.85', '0.09-32-0.85', '0.07-32-0.75', '0.07-32-0')
circuit.names <- c('circuit_4', 'circuit_3', 'circuit_1', 'circuit_2')
names(circuit.names) <- circuit_indices
View(common.nodes.df)
circuit_names <- c('circuit_1', 'circuit_2', 'circuit_3', 'circuit_4')
circuit_indices <- c('0.07-32-0.75', '0.07-32-0', '0.09-32-0.85', '0.16-28-0.85')
names(circuit_names) <- circuit_indices
nodes.all <- c()
tpo.list <- list()
nodes.byCircuit <- list()
nodes.all <- c()
tpo.list <- list()
nodes.byCircuit <- list()
for(circuit_idx in names(circuit_names)){
racipe <- readRDS(file = paste('../circuits.sim/circuit_simulated_',
circuit_idx, '.rds', sep = '') )
circuit_tpo <- sracipeCircuit(racipe)
fname.out <- paste(outdir, 'circuit-', circuit_idx, '.tpo' ,sep = '')
write.table(circuit_tpo, file = fname.out, sep = '\t', quote = F, row.names = F)
tpo.list[[circuit_names[circuit_idx]]] <- circuit_tpo
TFs_in_circuit <- union(circuit_tpo$Source, circuit_tpo$Target)
nodes.byCircuit[[circuit_names[circuit_idx]]] <- TFs_in_circuit
nodes.all <- c(nodes.all, TFs_in_circuit)
}
leng
length(nodes.all)
nodes.all <- unique(nodes.all)
length(nodes.all)
node.status <- as.data.frame(matrix(nrow = length(all.nodes), ncol = 2))
node.status <- as.data.frame(matrix(nrow = length(all.nodes), ncol = 2))
node.status <- as.data.frame(matrix(nrow = length(nodes.all), ncol = 2))
colnames(node.status) <- c('tf', 'status')
node.status$tf <- nodes.all
View(node.status)
node.status$status <- 1
common.nodes <- intersect(nodes.byCircuit$circuit_4, nodes.byCircuit$circuit_3)
common.nodes
node.status$tf %in% common.nodes
length(node.status$tf %in% common.nodes)
head(common.nodes)
node.status.df <- as.data.frame(matrix(nrow = length(nodes.all), ncol = 2))
colnames(node.status.df) <- c('tf', 'status')
node.status.df$tf <- nodes.all
node.status.df$status <- 1
common.nodes <- intersect(nodes.byCircuit$circuit_4, nodes.byCircuit$circuit_3)
node.status.df$tf %in% common.nodes
tmp1 <- node.status.df
node.status.df[node.status.df$tf %in% common.nodes, 2] <- 2
View(node.status.df)
sum(node.status.df$status==2)
length(common.nodes)
tmp2 <- node.status.df
common.nodes <- intersect(nodes.byCircuit$circuit_3, nodes.byCircuit$circuit_1)
length(common.nodes)
sum(node.status.df$status==2)
node.status.df <- as.data.frame(matrix(nrow = length(nodes.all), ncol = 2))
colnames(node.status.df) <- c('tf', 'status')
node.status.df$tf <- nodes.all
node.status.df$status <- 1
tmp1 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_3, nodes.byCircuit$circuit_4)
length(common.nodes)
length(new.nodes)
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 2
sum(node.status.df$status==2)
tmp2 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_1, nodes.byCircuit$circuit_3)
length(new.nodes)
t <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
length(t)
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 3
sum(node.status.df$status==3)
tmp3 <- node.status.df
tmp3 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_2, nodes.byCircuit$circuit_1)
length(new.nodes)
t1 <- setdiff(new.nodes, nodes.byCircuit$circuit_3)
length(t1)
t2 <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
length(t2)
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
new.nodes <- setdiff(nodes.byCircuit$circuit_2, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 4
sum(node.status.df$status==4) # 23
sum(node.status.df$status==1)
sum(node.status.df$status==2) # 22
sum(node.status.df$status==3) # 22
sum(node.status.df$status==4) # 22
sum(node.status.df$tf %in% nodes.byCircuit$circuit_2)
dim(node.status.df)
tmp <- node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, ]
dim(tmp)
node.status.df <- node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, ]
write.csv(node.status.df, file = paste0(outdir, 'node.status.csv'), quote = F, row.names = F)
all.nodes <- unique(union(all.nodes))
nodes.all <- unique(union(nodes.all))
nodes.all <- uniq(union(nodes.all))
nodes.all <- unique(union(nodes.all))
nodes.all <- unique(nodes.all)
length(nodes.all)
remove(list = ls())
#circuit_idx <- '0.07-32-0.75'
circuit_names <- c('circuit_1', 'circuit_2', 'circuit_3', 'circuit_4')
circuit_indices <- c('0.07-32-0.75', '0.07-32-0', '0.09-32-0.85', '0.16-28-0.85')
# names(circuit_indices) <- circuit_names
names(circuit_names) <- circuit_indices
library(sRACIPE)
outdir <- './tpo/'
outdir <- './'
dir.create(outdir)
# Extact circuits
#-----------------
nodes.all <- c()
tpo.list <- list()
nodes.byCircuit <- list()
for(circuit_idx in names(circuit_names)){
racipe <- readRDS(file = paste('../circuits.sim/circuit_simulated_',
circuit_idx, '.rds', sep = '') )
circuit_tpo <- sracipeCircuit(racipe)
fname.out <- paste(outdir, 'circuit-', circuit_idx, '.tpo' ,sep = '')
write.table(circuit_tpo, file = fname.out, sep = '\t', quote = F, row.names = F)
tpo.list[[circuit_names[circuit_idx]]] <- circuit_tpo
TFs_in_circuit <- union(circuit_tpo$Source, circuit_tpo$Target)
nodes.byCircuit[[circuit_names[circuit_idx]]] <- TFs_in_circuit
nodes.all <- c(nodes.all, TFs_in_circuit)
}
names(tpo.list)
names(nodes.byCircuit)
nodes.all <- unique(nodes.all) # 59
# find common nodes in each circuit pair
#---------------------------------------
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 4))
colnames(common.nodes.df) <- c('circuit.pair', 'num_common.nodes', 'nodeCount.pair', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(length(nodes.byCircuit[[circuit.1]]), '_', length(nodes.byCircuit[[circuit.2]]), sep = ''),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
write.csv(common.nodes.df, file = paste(outdir, 'common.nodes.csv', sep = ''), quote = F, row.names = F)
# get number of nodes in each circuit
#------------------------------------
nodes.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
colnames(nodes.df) <- c('circuit.name', 'num_nodes', 'circuit.idx')
count.circuit <- 1
for(n1 in 1:(length(circuit_names))){
circuit.name <- as.character(circuit_names[n1])
print(circuit.name)
nodes.df[count.circuit, ] <- c(circuit.name,  length(nodes.byCircuit[[circuit.name]]),  names(circuit_names[n1]))
count.circuit <- count.circuit + 1
}
write.csv(nodes.df, file = paste(outdir, 'nodes.perCircuit.csv', sep = ''), quote = F, row.names = F)
nodes.all <- unique(nodes.all)
View(nodes.df)
node.status.df <- as.data.frame(matrix(nrow = length(nodes.all), ncol = 2))
colnames(node.status.df) <- c('tf', 'status')
node.status.df$tf <- nodes.all
node.status.df$status <- 4
View(node.status.df)
nodes.byCircuit$circuit_4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_4, 2] <- 1
sum(node.status.df$status==1)
node.status.df$status <- 4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_3, 2] <- 1
sum(node.status.df$status==1)
tmp1 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_3, nodes.byCircuit$circuit_4)
length(new.nodes)
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, 2] <- 1
sum(node.status.df$status==1) # 29
node.status.df$status <- 4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, 2] <- 1
sum(node.status.df$status==1) # 29
node.status.df$status <- 4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, 2] <- 1
node.status.df$status <- 4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_4, 2] <- 1
sum(node.status.df$status==1) # 29
tmp1 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_3, nodes.byCircuit$circuit_4)
length(new.nodes) # 8
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 2
sum(node.status.df$status==2)
tmp2 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_1, nodes.byCircuit$circuit_3)
length(new.nodes)
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 3
sum(node.status.df$status==3) # 23
length(new.nodes)
tmp3 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_2, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
sum(node.status.df$status==4) # 6
sum(node.status.df$status==1) # 22
sum(node.status.df$status==2) # 8
sum(node.status.df$status==3) # 23
sum(node.status.df$status==4) # 6
dim(node.status.df) # 59 x 2
sum(node.status.df$tf %in% nodes.byCircuit$circuit_2) # 58
node.status.df <- node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, ]
write.csv(node.status.df, file = paste0(outdir, 'node.status.csv'), quote = F, row.names = F)
sum(node.status.df$tf=='TP63')
nodes.all <- unique(nodes.all)
node.status.df <- as.data.frame(matrix(nrow = length(nodes.all), ncol = 2))
colnames(node.status.df) <- c('tf', 'status')
node.status.df$tf <- nodes.all
node.status.df$status <- 4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_4, 2] <- 1
sum(node.status.df$status==1) # 22
tmp1 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_3, nodes.byCircuit$circuit_4)
length(new.nodes) # 8
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 2
sum(node.status.df$status==2)
tmp2 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_1, nodes.byCircuit$circuit_3)
length(new.nodes)
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 3
sum(node.status.df$status==3) # 23
tmp3 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_2, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
sum(node.status.df$status==4) # 6
sum(node.status.df$status==1) # 22
sum(node.status.df$status==2) # 8
sum(node.status.df$status==3) # 23
sum(node.status.df$status==4) # 6
nodes.all <- sort(nodes.all)
node.status.df <- as.data.frame(matrix(nrow = length(nodes.all), ncol = 2))
colnames(node.status.df) <- c('tf', 'status')
node.status.df$tf <- nodes.all
node.status.df$status <- 4
node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_4, 2] <- 1
sum(node.status.df$status==1) # 22
tmp1 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_3, nodes.byCircuit$circuit_4)
length(new.nodes) # 8
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 2
sum(node.status.df$status==2)
tmp2 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_1, nodes.byCircuit$circuit_3)
length(new.nodes)
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_4)
node.status.df[node.status.df$tf %in% new.nodes, 2] <- 3
sum(node.status.df$status==3) # 23
tmp3 <- node.status.df
new.nodes <- setdiff(nodes.byCircuit$circuit_2, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
new.nodes <- setdiff(new.nodes, nodes.byCircuit$circuit_1)
length(new.nodes) # 6
sum(node.status.df$status==4) # 6
sum(node.status.df$status==1) # 22
sum(node.status.df$status==2) # 8
sum(node.status.df$status==3) # 23
sum(node.status.df$status==4) # 6
sum(nodes.byCircuit$circuit_2 %in% 'TP63')
dim(node.status.df) # 59 x 2
sum(node.status.df$tf %in% nodes.byCircuit$circuit_2) # 58
sum(node.status.df$tf %in% nodes.byCircuit$circuit_2)
node.status.df <- node.status.df[node.status.df$tf %in% nodes.byCircuit$circuit_2, ] # 58 x 2 - TP63 is gone
dim(node.status.df)
write.csv(node.status.df, file = paste0(outdir, 'node.status.csv'), quote = F, row.names = F)
write.csv(node.status.df, file = paste0(outdir, 'node.status.csv'), quote = F, row.names = F)
sum(node.status.df$status==1)
remove(list = ls())
#circuit_idx <- '0.07-32-0.75'
circuit_names <- c('circuit_1', 'circuit_2', 'circuit_3', 'circuit_4')
circuit_indices <- c('0.07-32-0.75', '0.07-32-0', '0.09-32-0.85', '0.16-28-0.85')
# names(circuit_indices) <- circuit_names
names(circuit_names) <- circuit_indices
library(sRACIPE)
# outdir <- './tpo/'
# dir.create(outdir)
outdir <- './'
# Extact circuits
#-----------------
nodes.all <- c()
tpo.list <- list()
nodes.byCircuit <- list()
for(circuit_idx in names(circuit_names)){
racipe <- readRDS(file = paste('../circuits.sim/circuit_simulated_',
circuit_idx, '.rds', sep = '') )
circuit_tpo <- sracipeCircuit(racipe)
fname.out <- paste(outdir, 'circuit-', circuit_idx, '.tpo' ,sep = '')
write.table(circuit_tpo, file = fname.out, sep = '\t', quote = F, row.names = F)
tpo.list[[circuit_names[circuit_idx]]] <- circuit_tpo
TFs_in_circuit <- union(circuit_tpo$Source, circuit_tpo$Target)
nodes.byCircuit[[circuit_names[circuit_idx]]] <- TFs_in_circuit
nodes.all <- c(nodes.all, TFs_in_circuit)
}
names(tpo.list)
names(nodes.byCircuit)
nodes.all <- unique(nodes.all) # 59
# find common nodes in each circuit pair
#---------------------------------------
common.nodes.df <- as.data.frame(matrix(nrow = 6, ncol = 4))
colnames(common.nodes.df) <- c('circuit.pair', 'num_common.nodes', 'nodeCount.pair', 'circuit.idx.pair')
count.pair <- 1
for(n1 in 1:(length(circuit_names)-1)){
circuit.1 <- as.character(circuit_names[n1])
for(n2 in (n1+1):(length(circuit_names))){
circuit.2 <- as.character(circuit_names[n2])
common.tfs <- intersect(nodes.byCircuit[[circuit.1]], nodes.byCircuit[[circuit.2]])
common.nodes.df[count.pair, ] <-  c(paste(circuit.1, '.', circuit.2, sep = ''),
length(common.tfs),
paste(length(nodes.byCircuit[[circuit.1]]), '_', length(nodes.byCircuit[[circuit.2]]), sep = ''),
paste(names(circuit_names[n1]), '_', names(circuit_names[n2]), sep = ''))
count.pair <- count.pair + 1
#break()
}
#break()
}
write.csv(common.nodes.df, file = paste(outdir, 'common.nodes.csv', sep = ''), quote = F, row.names = F)
# get number of nodes in each circuit
#------------------------------------
nodes.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
colnames(nodes.df) <- c('circuit.name', 'num_nodes', 'circuit.idx')
count.circuit <- 1
for(n1 in 1:(length(circuit_names))){
circuit.name <- as.character(circuit_names[n1])
print(circuit.name)
nodes.df[count.circuit, ] <- c(circuit.name,  length(nodes.byCircuit[[circuit.name]]),  names(circuit_names[n1]))
count.circuit <- count.circuit + 1
}
write.csv(nodes.df, file = paste(outdir, 'nodes.perCircuit.csv', sep = ''), quote = F, row.names = F)
View(nodes.df)
paste(outdir, 'nodes.perCircuit.csv', sep = '')
View(nodes.df)
summary.status.df <- as.data.frame(matrix(nrow = 4, ncol = 3))
